<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Pluto - 
    Deploying Portlet to Pluto Portal</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          <meta name="author" content="
    ZHENG Zhong" />
          <meta name="author" content="
    David DeWolf" />
          <meta name="author" content="
    Craig Doremus" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="" id="bannerLeft">
    
                                            <img src="../images/apache-portals.gif" alt="" />
    
            </a>
                          <span id="bannerRight">
    
                                            <img src="../images/banner.png" alt="" />
    
            </span>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
            <div class="xleft">
        Last Published: 02/11/2007
                      </div>
            <div class="xright">      <a href="http://jcp.org/en/jsr/detail?id=168">JSR 168</a>
          |
          <a href="http://jcp.org/en/jsr/detail?id=286">JSR 286</a>
          |
          <a href="http://people.apache.org/~zheng/pluto/chinese/">Chinese Translation</a>
          
  

  
    
  
  
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
                   <h5>The Pluto Project</h5>
        <ul>
              
    <li class="none">
              <a href="../index.html">About Pluto</a>
        </li>
              
    <li class="none">
              <a href="../mission.html">Mission</a>
        </li>
              
    <li class="none">
              <a href="../download.html">Download</a>
        </li>
              
    <li class="none">
              <a href="../news.html">News</a>
        </li>
              
    <li class="none">
              <a href="../faq.html">FAQ</a>
        </li>
              
    <li class="none">
              <a href="http://wiki.apache.org/portals/Pluto">Wiki</a>
        </li>
              
    <li class="none">
              <a href="../powered.html">Powered By Pluto</a>
        </li>
              
    <li class="none">
              <a href="../get-involved.html">Get Involved</a>
        </li>
          </ul>
          <h5>Pluto 1.0.1</h5>
        <ul>
              
    <li class="none">
              <a href="../v101/install.html">Getting Started</a>
        </li>
              
    <li class="none">
              <a href="../v101/resources.html">Resources</a>
        </li>
              
          
              
      
            
      
              
        <li class="expanded">
              <a href="../v101/userguide/index.html">User Guide</a>
                <ul>
                  
    <li class="none">
              <a href="../v101/userguide/portal.html">Portal Guide</a>
        </li>
                  
    <li class="none">
              <a href="../v101/userguide/testsuite.html">Testsuite Guide</a>
        </li>
              </ul>
        </li>
              
          
              
      
            
      
            
      
            
      
              
        <li class="expanded">
              <a href="../v101/developer/index.html">Developer Guide</a>
                <ul>
                  
    <li class="none">
              <a href="../v101/developer/arch.html">Architecture</a>
        </li>
                  
    <li class="none">
              <a href="../v101/developer/subversion.html">Obtaining Source</a>
        </li>
                  
    <li class="none">
              <a href="../v101/developer/build_source.html">Building From Source</a>
        </li>
                  
    <li class="none">
              <a href="../v101/developer/integrate.html">Integrating</a>
        </li>
              </ul>
        </li>
          </ul>
          <h5>Pluto 1.1</h5>
        <ul>
              
    <li class="none">
              <a href="../v11/getting-started.html">Getting Started</a>
        </li>
              
    <li class="none">
              <strong>Deploying</strong>
        </li>
              
    <li class="none">
              <a href="../v11/app-servers.html">App Servers</a>
        </li>
              
    <li class="none">
              <a href="../v11/architecture.html">Architecture</a>
        </li>
              
    <li class="none">
              <a href="../v11/resources.html">Resources</a>
        </li>
              
          
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="expanded">
              <a href="../v11/subprojects.html">Subprojects</a>
                <ul>
                  
    <li class="none">
              <a href="../pluto-container/index.html">Portlet Container</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-taglib/index.html">Portlet Tags</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-portal-driver/index.html">Portal Driver</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-portal/index.html">Portal</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-testsuite/index.html">Testsuite</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-descriptor-api/index.html">Descriptor API</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-descriptor-impl/index.html">Descriptor Impl</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-optional-services/index.html">Optional Services</a>
        </li>
                  
    <li class="none">
              <a href="../maven-pluto-plugin/index.html">Maven Plugin</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-ant-tasks/index.html">Ant Tasks</a>
        </li>
                  
    <li class="none">
              <a href="../pluto-util/index.html">Util</a>
        </li>
              </ul>
        </li>
          </ul>
          <h5>Project Documentation</h5>
        <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="../project-info.html">Project Information</a>
              </li>
          </ul>
                                       <a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy">
            <img alt="Built by Maven" src="../images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
  
  
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
  
  
  
  
    
    <a name="Deploying Portlet to Pluto Portal"></a><div class="section"><h2>Deploying Portlet to Pluto Portal</h2>
      
      <p>
        There are 2 involved in deploying a portlet application Pluto 1.1:
        <ul>
          <li>
            <b>Assembly</b>: All portlet applications must be run through the
            pluto assembler before being deployed. The assembly process injects
            pluto specific information for deployment. Specifically, a servlet
            and servlet mapping are added to the deployment descriptor (web.xml). 
            This servlet (<code>org.apache.pluto.core.PortletServlet</code>) will be 
            used to dispatch portlet requests to the portlet application.
          </li>
          <li>
            <b>Deployment</b>: After portlet applications are assembled properly
            they must be deployed to the servlet engine within which the portal
            application is running. The current binary distribution uses
            Tomcat 5.5 as the servlet engine.
          </li>
        </ul>
      
      
      <a name="Portlet Assembly"></a><div class="section"><h3>Portlet Assembly</h3>
        
            The maven-pluto-plugin can be used to assemble a portlet application war.
            It will place the proper <code>PortletServlet</code> configuration in web.xml.
        
        <p>          
          The custom Maven 2 build shown below also deploys
          a Tomcat context deployment descriptor that has the same name as your
          artifactId with an xml extension (e.g. HelloWorldPortlet.xml).
        </p>
        <p>
          To properly assemble your portlet using the Maven 2 plugin,
          your project's directory structure and artifact placement must conform to Maven's standard:
        </p>
        <p>
          <div class="source"><pre>
	HelloWorldPortlet (top level directory)
	|- pom.xml (the pom file)
	|- src (Subdir containing main subdirectory)
	    |- main (Subdir containing java, resources and webapp subdirs)
	    	|- java (java source code goes under here)
		    |       `- com
		    |           `- mycompany
		    |               `- portlet
		    |                   `- HelloWorldPortlet.java (portlet source)
		    |- resources
		    |	`- HelloWorldPortlet.xml (Tomcat context deployment descriptor)
		    |- webapp  (webapp resources (jsp, css, images) go under here)
		    	`- jsp 
		    		`- HelloWorldPortletView.jsp (for view mode)		    			    
		    		`- HelloWorldPortletEdit.jsp (for edit mode)		    			    
		    	`- WEB-INF
			    	`- portlet.xml (JSR-168 deployment descriptor)
			    	`- web.xml (This will be modified by maven-pluto-plugin)
          </pre></div>
        </p>

        <p>
        This is an example of what the Tomcat context deployment descriptor will contain:
          <div class="source"><pre>
		&lt;Context path=&quot;HelloWorldPortlet&quot; 
			docBase=&quot;../PlutoDomain/HelloWorldPortlet.war&quot; 
			crossContext=&quot;true&quot;/&gt;        
          </pre></div>
        </p>
        <p>
        To configure the maven-pluto-plugin, you must configure it in your pom.
        For easy of setup, use this as you pom file, changing the groupId, artifactId and version
        to values appropriate to your custom portlet.
          <div class="source"><pre>
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
  
  &lt;!-- Change this to something akin to your java package structure --&gt;
  &lt;groupId&gt;com.mycompany.portlet&lt;/groupId&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;!-- Version of this app --&gt;
  &lt;version&gt;0.1-alpha1&lt;/version&gt;
  &lt;!-- Base name of the war file without .war ext --&gt;
  &lt;artifactId&gt;HelloWorldPortlet&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;
  &lt;name&gt;${pom.artifactId}&lt;/name&gt;
  &lt;!-- Dependency Version Properties ======================================= --&gt;
  &lt;properties&gt;
  	&lt;!-- Change this for a new Pluto version --&gt;
    &lt;pluto.version&gt;1.1.0&lt;/pluto.version&gt;
    &lt;portlet-api.version&gt;1.0&lt;/portlet-api.version&gt;
    &lt;servlet-api.version&gt;2.4&lt;/servlet-api.version&gt;
    &lt;jsp-api.version&gt;2.0&lt;/jsp-api.version&gt;
    &lt;junit.version&gt;3.8.1&lt;/junit.version&gt;
  &lt;/properties&gt;  
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;javax.portlet&lt;/groupId&gt;
      &lt;artifactId&gt;portlet-api&lt;/artifactId&gt;
      &lt;version&gt;${portlet-api.version}&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;&lt;!-- Prevents addition to war file --&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
      &lt;version&gt;${servlet-api.version}&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;${junit.version}&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.pluto&lt;/groupId&gt;
      &lt;artifactId&gt;pluto-util&lt;/artifactId&gt;
      &lt;version&gt;${pluto.version}&lt;/version&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- Any other build or deployment dependancies go here --&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;finalName&gt;${pom.name}&lt;/finalName&gt;
    &lt;plugins&gt;
      &lt;!-- configure maven-war-plugin to use updated web.xml --&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;webXml&gt;${project.build.directory}/pluto-resources/web.xml&lt;/webXml&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;!-- bind 'pluto:assemble' goal to 'process-resources' lifecycle --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.pluto&lt;/groupId&gt;
        &lt;artifactId&gt;maven-pluto-plugin&lt;/artifactId&gt;
        &lt;version&gt;${pluto.version}&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;generate-resources&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;assemble&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  
&lt;/project&gt;
          </pre></div>
        </p>        
        <p>
            Once configured, the war generated by an 'mvn package' (or install) will contain
            the appropriate pluto configuration.
        </p>
      </div>

        <a name="Portlet Deployment"></a><div class="section"><h3>Portlet Deployment</h3>
           <p>
               To deploy a portlet application, simply deploy the application war
               using any standard mechanism for your application server.  There are many
               maven plugins and ant tasks that can assist with this, or you can use
               a manager web console. This console is pointed to the Tomcat manager webapp in the
               Pluto binary distribution and is accessed via the 'Upload and deploy portlet war' link
               on the page administration portlet. See the Help link on that portlet for more details.
           </p>
        </div>
            
      <a name="Portlet Publishing"></a><div class="section"><h3>Portlet Publishing</h3>
        <p>
        As soon as the portlet application (war) is deployed to the servlet container
        the portlet application will be available to the portal and can be added to
        pages using the page administration portlet. See the help mode in this portlet
        for details on its use.
        </p>
        
        <p><b>Portal Page Configuration</b></p>
        <p>
          If you'd like for your page configuration to be consistent throughout
          restarts of the application server (currently placements made through
          the page administration portlet is not persistent), you should then configure the page
          layout in the portal-driver configuration file (pluto-portal-driver-config.xml).
        </p>
        <p>
		  The portlet application should be first configured in pluto-portal-driver-config.xml by
		  adding a <code>portlet-app</code> element with appropriate child elements like this:
			<div class="source"><pre>
&lt;portlet-app&gt;
    &lt;context-path&gt;/your_portlet_app_context_path&lt;/context-path&gt;
    &lt;portlets&gt;
      &lt;portlet name=&quot;your_portlet_1&quot;/&gt;
      &lt;portlet name=&quot;your_portlet_2&quot;/&gt;
    &lt;/portlets&gt;
&lt;/portlet-app&gt;
			</pre></div>      
        </p>
        <p>
          The page can then be configured by adding a <code>page</code> element in the <code>render-config</code> 
          element, like this:
          <div class="source"><pre>
&lt;render-config default=&quot;Test Page&quot;&gt;
  ... ...
  &lt;page name=&quot;Your Portal Page Name&quot; uri=&quot;/WEB-INF/fragments/portlet.jsp&quot;&gt;
    &lt;portlet context=&quot;/your_portlet_app_context_path&quot;
             name=&quot;your_portlet_1&quot;/&gt;
    &lt;portlet context=&quot;/your_portlet_app_context_path&quot;
             name=&quot;your_portlet_2&quot;/&gt;
  &lt;/page&gt;
&lt;/render-config&gt;
          </pre></div>
        </p>
        <p>
          The <code>uri</code> attribute defines the theme of your portal page.
          If you use <code>/WEB-INF/fragments/portlet.jsp</code> (which is the
          default theme of Pluto Testsuite portlet app), your portlets will be
          displayed in two columns. You can clone this file to customize your layout.
          If you do so, make sure the <code>uri</code> attribute points to the new file.
        </p>
        <p>
         The value of the <code>context-path element</code> within the <code>portlet-app</code> record must correspond to the 
         value of the <code>context</code> attribute in the <code>portlet</code> element. In addition, the value of the
         <code>name</code> attribute in the <code>portlet</code> child element of <code>portlet-app</code> must correspond to 
         the value of the <code>name</code> attribute of the <code>portlet</code> child element of page. 
        </p>
      </div>
      
    </div>
    
  
  

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2001-2007
    
          Apache Software Foundation
          
  

  
    
  
  
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
